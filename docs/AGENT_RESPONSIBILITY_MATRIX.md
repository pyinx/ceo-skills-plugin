# Agent职责边界矩阵

**文档版本**: 1.0
**创建日期**: 2025-01-23

---

## 📊 职责分配矩阵

### 按功能模块划分

| 功能模块 | Architect | Designer | Fullstack | Mobile | Test Engineer |
|----------|-----------|----------|-----------|--------|---------------|
| **技术选型** | ✅ 负责 | ❌ | ❌ | ❌ | ❌ |
| **架构设计** | ✅ 负责 | ❌ | ❌ | ❌ | ❌ |
| **API设计** | ✅ 负责 | ❌ | ❌ | ❌ | ❌ |
| **数据模型设计** | ✅ 负责 | ❌ | ❌ | ❌ | ❌ |
| **用户故事** | ❌ | ✅ 负责 | ❌ | ❌ | ❌ |
| **交互设计** | ❌ | ✅ 负责 | ❌ | ❌ | ❌ |
| **视觉设计** | ❌ | ✅ 负责 | ❌ | ❌ | ❌ |
| **设计规范** | ❌ | ✅ 负责 | ❌ | ❌ | ❌ |
| **后端API实现** | ❌ | ❌ | ✅ 负责 | ❌ | ❌ |
| **数据库实现** | ❌ | ❌ | ✅ 负责 | ❌ | ❌ |
| **Web前端实现** | ❌ | ❌ | ✅ 负责 | ❌ | ❌ |
| **移动端UI实现** | ❌ | ❌ | ❌ | ✅ 负责 | ❌ |
| **移动端状态管理** | ❌ | ❌ | ❌ | ✅ 负责 | ❌ |
| **原生功能集成** | ❌ | ❌ | ❌ | ✅ 负责 | ❌ |
| **API集成（调用）** | ❌ | ❌ | ✅ Web | ✅ Mobile | ❌ |
| **单元测试** | ❌ | ❌ | ✅ 实现 | ✅ 实现 | ❌ |
| **测试策略** | ❌ | ❌ | ❌ | ❌ | ✅ 负责 |
| **集成测试** | ❌ | ❌ | ❌ | ❌ | ✅ 负责 |
| **E2E测试** | ❌ | ❌ | ❌ | ❌ | ✅ 负责 |
| **性能测试** | ❌ | ❌ | ❌ | ❌ | ✅ 负责 |

### 按项目阶段划分

| 阶段 | 主要负责 | 协作 | 输出 |
|------|----------|------|------|
| **阶段1：需求澄清** | Product Manager | - | PRD |
| **阶段2：产品设计** | UI/UX Designer | - | 用户故事、Figma设计 |
| **阶段3：架构设计** | System Architect | - | 架构文档、API规范 |
| **阶段3.3：平台决策** | System Architect | Product Manager | 平台决策 |
| **阶段4.1：后端开发** | Fullstack Developer | Architect指导 | 后端API |
| **阶段4.2：Web开发** | Fullstack Developer | Designer规范 | Web应用 |
| **阶段4.3：移动开发** | Mobile Developer | Designer规范 | 移动应用 |
| **阶段5：测试验证** | Test Engineer | Developers协作 | 测试报告 |
| **阶段6：交付部署** | Marketing Specialist | - | 部署文档 |

---

## 🔄 协作流程图

### 决策层 → 实现层流程

```
┌─────────────────────────────────────────────────────────────┐
│                        决策层                                │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌──────────────────┐         ┌──────────────────┐          │
│  │ System Architect │         │ UI/UX Designer   │          │
│  │                  │         │                  │          │
│  │ • 技术架构       │         │ • 用户故事       │          │
│  │ • API规范        │────────▶│ • 交互设计       │          │
│  │ • 数据模型       │         │ • 视觉设计       │          │
│  │ • 安全架构       │         │ • 设计规范       │          │
│  └──────────────────┘         └──────────────────┘          │
│           │                            │                     │
│           └────────────┬───────────────┘                     │
│                        ▼                                     │
│              ┌──────────────────┐                           │
│              │  平台决策        │                           │
│              │  Web/Mobile/Both │                           │
│              └──────────────────┘                           │
└─────────────────────────────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────────┐
│                        实现层                                │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌──────────────────────────────────────────────────┐        │
│  │         Fullstack Developer                       │        │
│  │                                                   │        │
│  │  ┌──────────────┐        ┌──────────────┐        │        │
│  │  │  后端API     │        │  Web前端     │        │        │
│  │  │  (统一负责)  │◀───────│  (如需要)    │        │        │
│  │  └──────────────┘        └──────────────┘        │        │
│  │         │                         │              │        │
│  │         └────────────┬────────────┘              │        │
│  │                      ▼                           │        │
│  │              ┌──────────────┐                    │        │
│  │              │  API文档     │                    │        │
│  │              └──────────────┘                    │        │
│  └──────────────────────────────────────────────────┘        │
│                        │                                     │
│                        ▼                                     │
│  ┌──────────────────────────────────────────────────┐        │
│  │         Mobile Developer                          │        │
│  │                                                   │        │
│  │  ┌──────────────┐        ┌──────────────┐        │        │
│  │  │  移动端UI    │        │  API集成     │        │        │
│  │  │  (iOS/And)   │◀───────│  (调用API)   │        │        │
│  │  └──────────────┘        └──────────────┘        │        │
│  │         │                                          │        │
│  │         ▼                                          │        │
│  │  ┌──────────────┐                                  │        │
│  │  │  原生功能    │                                  │        │
│  │  │  (GPS/相机)  │                                  │        │
│  │  └──────────────┘                                  │        │
│  └──────────────────────────────────────────────────┘        │
└─────────────────────────────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────────────────┐
│                        验证层                                │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌──────────────────────────────────────────────────┐        │
│  │         Test Engineer                             │        │
│  │                                                   │        │
│  │  • 测试策略                                       │        │
│  │  • 集成测试 (Web)                                 │        │
│  │  • 集成测试 (Mobile)                              │        │
│  │  • E2E测试                                        │        │
│  │  • 性能测试                                       │        │
│  └──────────────────────────────────────────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎯 边界清晰化示例

### 示例1：API开发边界

#### ❌ 混乱的做法

```
System Architect: 设计API → 写代码实现API
Fullstack Developer: 使用API
Mobile Developer: 发现API有问题 → 重新设计API
```

#### ✅ 清晰的做法

```
System Architect:
  - 设计API规范（接口、参数、返回值）
  - 定义数据模型（TypeScript类型）
  - 输出：API文档、类型定义

Fullstack Developer:
  - 按照规范实现后端API
  - 生成API文档
  - 输出：可运行的API、API文档

Mobile Developer:
  - 使用API文档
  - 调用API
  - 输出：API客户端代码

Test Engineer:
  - 验证API符合规范
  - 测试API功能
  - 输出：测试报告
```

---

### 示例2：UI开发边界

#### ❌ 混乱的做法

```
UI/UX Designer: 设计UI → 写HTML/CSS
Fullstack Developer: 重新设计UI → 实现
Mobile Developer: 自己设计移动端UI → 实现
```

#### ✅ 清晰的做法

```
UI/UX Designer:
  - 设计用户体验流程
  - 创建Figma设计稿
  - 定义Design tokens
  - 输出：设计规范、设计稿

Fullstack Developer (Web):
  - 按照设计规范实现Web UI
  - 使用Design tokens
  - 输出：Web组件

Mobile Developer:
  - 按照设计规范实现Mobile UI
  - 使用Design tokens
  - 实现移动端适配
  - 输出：移动端组件

Test Engineer:
  - 验证UI符合设计规范
  - 测试UI交互
  - 输出：UI测试报告
```

---

### 示例3：状态管理边界

#### ❌ 混乱的做法

```
System Architect: 决定用什么状态管理
Fullstack Developer: 实现Web状态管理
Mobile Developer: 完全不同的状态管理方案
```

#### ✅ 清晰的做法

```
System Architect:
  - 定义状态管理架构
  - 决定用什么技术栈
  - 定义状态结构
  - 输出：状态管理规范文档

Fullstack Developer (Web):
  - 实现Web端状态管理
  - 遵循架构师定义的结构
  - 输出：Web状态管理代码

Mobile Developer:
  - 实现Mobile端状态管理
  - 遵循架构师定义的结构
  - 输出：Mobile状态管理代码

共享:
  - TypeScript类型定义
  - 状态结构定义
```

---

## 📦 共享契约结构

### 项目目录结构

```
project/
├── packages/
│   ├── shared-types/          # 共享类型定义
│   │   ├── src/
│   │   │   ├── entities/      # 实体类型
│   │   │   ├── api/           # API类型
│   │   │   └── index.ts
│   │   └── package.json
│   │
│   └── design-tokens/         # 共享设计规范
│       ├── src/
│       │   ├── colors.ts      # 色彩规范
│       │   ├── typography.ts  # 字体规范
│       │   ├── spacing.ts     # 间距规范
│       │   └── components/    # 组件规范
│       └── package.json
│
├── services/
│   └── backend-api/           # 后端API（Fullstack负责）
│       ├── src/
│       │   ├── routes/        # API路由
│       │   ├── models/        # 数据模型
│       │   └── services/      # 业务逻辑
│       └── package.json
│
├── web/                       # Web前端（Fullstack负责）
│   ├── src/
│   │   ├── components/        # React组件
│   │   ├── pages/             # 页面
│   │   └── state/             # Web状态管理
│   └── package.json
│
└── mobile/                    # 移动端（Mobile负责）
    ├── app/                   # Expo Router页面
    ├── components/            # React Native组件
    ├── stores/                # Mobile状态管理
    └── package.json
```

### 依赖关系

```
shared-types
  ↑ 被...依赖
  ├── backend-api (实现)
  ├── web (使用)
  └── mobile (使用)

design-tokens
  ↑ 被...依赖
  ├── web (使用)
  └── mobile (使用)

backend-api
  ↑ 被...调用
  ├── web
  └── mobile
```

---

## 🔍 边界检查清单

### 在开始开发前，检查：

#### System Architect
- [ ] 是否定义了技术栈？
- [ ] 是否定义了API规范？
- [ ] 是否定义了数据模型？
- [ ] 是否定义了安全规范？
- [ ] 是否没有涉及具体实现代码？

#### UI/UX Designer
- [ ] 是否定义了用户故事？
- [ ] 是否提供了Figma设计稿？
- [ ] 是否定义了Design tokens？
- [ ] 是否定义了响应式规则？
- [ ] 是否没有涉及技术实现？

#### Fullstack Developer
- [ ] 是否遵循了Architect的架构设计？
- [ ] 是否遵循了Designer的设计规范？
- [ ] 是否实现了后端API？
- [ ] 是否实现了Web前端（如需要）？
- [ ] 是否没有涉及移动端实现？

#### Mobile Developer
- [ ] 是否遵循了Architect的架构设计？
- [ ] 是否遵循了Designer的设计规范？
- [ ] 是否调用了Fullstack实现的API？
- [ ] 是否实现了移动端UI？
- [ ] 是否没有重新实现后端逻辑？

#### Test Engineer
- [ ] 是否定义了测试策略？
- [ ] 是否覆盖了所有平台？
- [ ] 是否验证了API符合规范？
- [ ] 是否验证了UI符合设计？
- [ ] 是否没有编写单元测试（由developer负责）？

---

## 🎯 关键原则

### 1. 单一职责原则

每个agent只负责自己的职责范围：
- Architect：设计架构，不写实现代码
- Designer：设计UI，不写实现代码
- Developer：实现功能，不做架构决策
- Test Engineer：验证质量，不实现功能

### 2. 契约驱动原则

通过明确的契约进行协作：
- API契约：OpenAPI/Swagger
- 数据契约：TypeScript类型
- 设计契约：Design tokens
- 测试契约：测试规范

### 3. 平台分离原则

Web和Mobile是平行的实现层：
- 共享：架构、设计、API
- 独立：UI实现、平台特定功能
- 统一：后端API由Fullstack负责

### 4. 动态激活原则

根据需求动态激活agents：
- Web Only → Fullstack (Web + Backend)
- Mobile Only → Fullstack (Backend) + Mobile
- Both → Fullstack (Web + Backend) + Mobile

---

## 📚 相关文档

- [Agent职责边界与Workflow集成方案](./AGENT_BOUNDARIES_AND_WORKFLOW.md)
- [移动端技术栈分析](./MOBILE_TECH_STACK_ANALYSIS.md)
- [移动端快速开始](./MOBILE_QUICK_START.md)

---

**文档结束**
